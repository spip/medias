<BOUCLE_file (DOCUMENTS) {id_document=#ENV{id,#ENV{id_document}}} {tout}>
[(#MEDIA|=={image}|oui)
	#SET{fichier,#URL_DOCUMENT}
	#SET{width,#LARGEUR}
	#SET{height,#HAUTEUR}
	#SET{url,#ENV{lien}}
][(#MEDIA|=={image}|non)
	#SET{image,#LOGO_DOCUMENT}
	[(#SET{fichier,[(#GET{image}|extraire_attribut{src})]})]
	[(#SET{width,[(#GET{image}|extraire_attribut{width})]})]
	[(#SET{height,[(#GET{image}|extraire_attribut{height})]})]
	#SET{url,#ENV{lien,#URL_DOCUMENT}}
][<!--(#REM)


	Si largeur ou hauteur fournit en parametre, redimensionner

-->][
(#ENV{largeur,0}|ou{#ENV{hauteur,0}})
	#SET{fichier,#GET{fichier}|image_reduire{#ENV{largeur,0},#ENV{hauteur,0}}}
	#SET{width,#GET{fichier}|largeur}
	#SET{height,#GET{fichier}|hauteur}
	#SET{fichier,#GET{fichier}|extraire_attribut{src}}
]
[(#SET{title,[(#TYPE_DOCUMENT) - [(#TAILLE|taille_en_octets)]]})]
[(#MEDIA|=={image}|oui) #SET{title,#TITRE|sinon{#GET{title}}]
<figure class='spip_document_#ID_DOCUMENT spip_documents spip_document_file[ spip_documents_(#ENV{align})][ (#ENV{class})] spip_lien_ok' [ style='width:(#GET{width}|max{120})px;']>
[<a href="(#GET{url})"[
	class="(#ENV{lien_class})"] title='[(#GET{title}|attribut_html)]'[
	(#ENV{lien}|?{'',type="#MIME_TYPE"})]>]<img src='#GET{fichier}' width='#GET{width}' height='#GET{height}' alt='' />[(#GET{url}|?{</a>})]
[(#TITRE|trim|sinon{#DESCRIPTIF|trim}|sinon{#CREDITS|trim}|oui)
  <figcaption class='spip_doc_legende'>
    [<div class='spip_doc_titre #EDIT{titre}'><strong>(#TITRE|propre|ptobr)</strong></div>]
    [<div class='spip_doc_descriptif #EDIT{descriptif}'>(#DESCRIPTIF|propre|PtoBR)[(#NOTES|PtoBR)]</div>]
    [<div class='spip_doc_credits  #EDIT{credits}'>(#CREDITS|propre|PtoBR)</div>]
  </figcaption>
]
</figure>
</BOUCLE_file>
#FILTRE{trim}